<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gift Card Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to right, #ece9e6, #ffffff);
      padding: 30px;
      color: #333;
      text-align: center;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }
    h1, h2 {
      margin-bottom: 20px;
    }
    .card-option {
      display: inline-block;
      width: 180px;
      margin: 15px;
      padding: 20px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
      text-align: center;
      user-select: none;
    }
    .card-option:hover, .card-option.selected {
      transform: scale(1.05);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
      border: 2px solid #007bff;
    }
    .card-option img {
      width: 100px;
      height: 60px;
      object-fit: contain;
      margin-bottom: 10px;
    }
    button {
      background-color: #007bff;
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
      user-select: none;
    }
    button:hover:not(:disabled) {
      background-color: #0056b3;
    }
    button:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }
    input {
      padding: 10px;
      font-size: 16px;
      width: 280px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 10px;
      transition: border-color 0.3s;
    }
    input.error {
      border-color: red;
    }
    .error-message {
      color: red;
      font-size: 12px;
      margin-top: 5px;
      height: 16px;
    }
    .section {
      display: none;
      margin-top: 30px;
      animation: fadeIn 0.8s ease-in-out;
      width: 100%;
      max-width: 400px;
    }
    .spinner, .overlay {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .spinner {
      border: 8px solid #f3f3f3;
      border-top: 8px solid #3498db;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(255, 255, 255, 0.8);
      z-index: 1000;
      display: none;
    }
    .stripe-loader {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: linear-gradient(45deg, #007bff, #00d4ff);
      animation: bounce 0.8s infinite alternate;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes bounce { 0% { transform: scale(1); } 100% { transform: scale(1.3); } }
    .green-tick { font-size: 60px; color: green; animation: pop 0.6s ease-in-out; }
    @keyframes pop {
      0% { transform: scale(0.5); opacity: 0; }
      80% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(1); }
    }
    .secure-label {
      margin: 10px auto 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: green;
      font-weight: bold;
    }
    .secure-label i {
      margin-right: 8px;
    }
    .copy-btn {
      margin-top: 15px;
      background: green;
    }
    .progress-bar {
      width: 0%;
      height: 5px;
      background: green;
      transition: width 1s;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1100;
    }
    .dark-mode {
      background: #333;
      color: #fff;
    }
    .dark-mode button {
      background-color: #555;
    }
    @media screen and (max-width: 600px) {
      .card-option { width: 90%; }
      input { width: 90%; }
      .section { max-width: 90vw; }
    }
  </style>
</head>
<body>

<div class="progress-bar" id="progressBar"></div>

<h1>Select a Gift Card</h1>

<div id="card-options">
  <div class="card-option" data-card="Amazon">
    <img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" alt="Amazon" />
    <p>Amazon</p>
  </div>
  <div class="card-option" data-card="Flipkart">
    <img src="https://1000logos.net/wp-content/uploads/2021/02/Flipkart-logo.png" alt="Flipkart" />
    <p>Flipkart</p>
  </div>
  <div class="card-option" data-card="BookMyShow">
    <img src="https://assets-in.bmscdn.com/static/2023/03/bms-logo-new.png" alt="BookMyShow" />
    <p>BookMyShow</p>
  </div>
  <div class="card-option" data-card="Zomato">
    <img src="https://upload.wikimedia.org/wikipedia/commons/7/75/Zomato_logo.png" alt="Zomato" />
    <p>Zomato</p>
  </div>
</div>

<!-- Amount & Email Section -->
<div id="amount-section" class="section">
  <h2>Enter Amount for <span id="selected-card"></span></h2>
  <div style="font-size: 22px;">$ <input type="number" id="amount" placeholder="Enter amount (min $10)" min="10" /></div>
  <div class="error-message" id="amount-error"></div>
  <input type="email" id="email" placeholder="Enter your email to receive card" />
  <div class="error-message" id="email-error"></div>
  <button id="to-payment" disabled>Proceed to Payment</button>
</div>

<!-- Payment Method Section -->
<div id="payment-section" class="section">
  <h2>Select Payment Method</h2>
  <button id="pay-upi">Pay with UPI</button>
  <button id="pay-card">Credit/Debit Card</button>
  <button id="back-to-amount" style="margin-top:15px; background:#888;">Back</button>
</div>

<!-- Card Payment Form -->
<div id="card-form" class="section">
  <h2>Enter Card Details</h2>
  <div class="secure-label"><i class="fas fa-lock"></i>SSL Secured</div>
  <input type="text" id="card-number" placeholder="Card Number" maxlength="19" />
  <div class="error-message" id="card-number-error"></div>
  <input type="text" id="expiry-date" placeholder="Expiry Date (MM/YY)" maxlength="5" />
  <div class="error-message" id="expiry-error"></div>
  <input type="password" id="cvv" placeholder="CVV" maxlength="3" />
  <div class="error-message" id="cvv-error"></div>
  <input type="text" id="card-holder" placeholder="Card Holder Name" />
  <div class="error-message" id="card-holder-error"></div>
  <button id="pay-now">Pay Now</button>
  <button id="back-to-payment" style="margin-top:15px; background:#888;">Back</button>
</div>

<!-- Loading Section -->
<div id="loading-section" class="section">
  <h2>Processing Payment...</h2>
  <div class="spinner"></div>
</div>

<!-- Confirmation Section -->
<div id="confirmation-section" class="section">
  <h2>Payment Successful</h2>
  <div class="green-tick">âœ”</div>
  <p>Your gift card code:</p>
  <h3 id="gift-code"></h3>
  <button class="copy-btn" id="copy-code">Copy Code</button>
  <button id="start-over" style="margin-top: 20px; background:#555;">Buy Another Card</button>
</div>

<script>
  // Variables to store state
  let selectedCard = '';
  let amount = 0;
  let email = '';

  // DOM Elements
  const cardOptions = document.querySelectorAll('.card-option');
  const amountSection = document.getElementById('amount-section');
  const paymentSection = document.getElementById('payment-section');
  const cardFormSection = document.getElementById('card-form');
  const loadingSection = document.getElementById('loading-section');
  const confirmationSection = document.getElementById('confirmation-section');

  const selectedCardSpan = document.getElementById('selected-card');
  const amountInput = document.getElementById('amount');
  const emailInput = document.getElementById('email');
  const toPaymentBtn = document.getElementById('to-payment');

  const payUpiBtn = document.getElementById('pay-upi');
  const payCardBtn = document.getElementById('pay-card');
  const backToAmountBtn = document.getElementById('back-to-amount');

  const cardNumberInput = document.getElementById('card-number');
  const expiryInput = document.getElementById('expiry-date');
  const cvvInput = document.getElementById('cvv');
  const cardHolderInput = document.getElementById('card-holder');
  const payNowBtn = document.getElementById('pay-now');
  const backToPaymentBtn = document.getElementById('back-to-payment');

  const progressBar = document.getElementById('progressBar');

  // Error message elements
  const amountError = document.getElementById('amount-error');
  const emailError = document.getElementById('email-error');
  const cardNumberError = document.getElementById('card-number-error');
  const expiryError = document.getElementById('expiry-error');
  const cvvError = document.getElementById('cvv-error');
  const cardHolderError = document.getElementById('card-holder-error');

  // Utility Functions
  function showSection(section) {
    // Hide all
    [amountSection, paymentSection, cardFormSection, loadingSection, confirmationSection].forEach(sec => sec.style.display = 'none');
    // Show the requested
    section.style.display = 'block';
  }

  function resetErrors() {
    [amountError, emailError, cardNumberError, expiryError, cvvError, cardHolderError].forEach(e => e.innerText = '');
    [amountInput, emailInput, cardNumberInput, expiryInput, cvvInput, cardHolderInput].forEach(input => input.classList.remove('error'));
  }

  // Card Selection Handler
  cardOptions.forEach(card => {
    card.addEventListener('click', () => {
      // Deselect all
      cardOptions.forEach(c => c.classList.remove('selected'));
      // Select clicked
      card.classList.add('selected');
      selectedCard = card.getAttribute('data-card');
      selectedCardSpan.innerText = selectedCard;
      // Show amount section
      showSection(amountSection);
      // Reset amount & email fields
      amountInput.value = '';
      emailInput.value = '';
      toPaymentBtn.disabled = true;
      resetErrors();
    });
  });

  // Amount and Email Validation
  function validateAmountEmail() {
    let valid = true;
    resetErrors();

    const amt = parseFloat(amountInput.value);
    if (isNaN(amt) || amt < 10) {
      amountError.innerText = 'Please enter a valid amount (minimum $10).';
      amountInput.classList.add('error');
      valid = false;
    }
    const mail = emailInput.value.trim();
    if (!mail || !/^\S+@\S+\.\S+$/.test(mail)) {
      emailError.innerText = 'Please enter a valid email.';
      emailInput.classList.add('error');
      valid = false;
    }

    toPaymentBtn.disabled = !valid;
    if (valid) {
      amount = amt;
      email = mail;
    }
  }

  amountInput.addEventListener('input', validateAmountEmail);
  emailInput.addEventListener('input', validateAmountEmail);

  toPaymentBtn.addEventListener('click', () => {
    showSection(paymentSection);
  });

  // Back button from payment to amount
  backToAmountBtn.addEventListener('click', () => {
    showSection(amountSection);
  });

  // Payment Method Handlers
  payUpiBtn.addEventListener('click', () => {
    processPayment('UPI');
  });
  payCardBtn.addEventListener('click', () => {
    showSection(cardFormSection);
    resetCardForm();
  });

  // Back button from card form to payment method
  backToPaymentBtn.addEventListener('click', () => {
    showSection(paymentSection);
  });

  // Format card number input with spaces
  cardNumberInput.addEventListener('input', (e) => {
    let value = e.target.value.replace(/\D/g, '');
    value = value.match(/.{1,4}/g)?.join(' ') || '';
    e.target.value = value;
  });

  // Format expiry date as MM/YY
  expiryInput.addEventListener('input', (e) => {
    let val = e.target.value.replace(/\D/g, '');
    if (val.length > 2) {
      val = val.slice(0,2) + '/' + val.slice(2,4);
    }
    e.target.value = val;
  });

  // Reset card form inputs and errors
  function resetCardForm() {
    [cardNumberInput, expiryInput, cvvInput, cardHolderInput].forEach(input => input.value = '');
    [cardNumberError, expiryError, cvvError, cardHolderError].forEach(err => err.innerText = '');
    [cardNumberInput, expiryInput, cvvInput, cardHolderInput].forEach(input => input.classList.remove('error'));
  }
  <script>
  // Validation for card details
  function validateCardDetails() {
    let valid = true;
    // Reset errors
    cardNumberError.innerText = '';
    expiryError.innerText = '';
    cvvError.innerText = '';
    cardHolderError.innerText = '';

    [cardNumberInput, expiryInput, cvvInput, cardHolderInput].forEach(i => i.classList.remove('error'));

    // Validate card number: 16 digits (spaces allowed)
    let cardNumRaw = cardNumberInput.value.replace(/\s/g, '');
    if (!/^\d{16}$/.test(cardNumRaw)) {
      cardNumberError.innerText = 'Enter a valid 16-digit card number.';
      cardNumberInput.classList.add('error');
      valid = false;
    }

    // Validate expiry MM/YY and check valid month
    if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiryInput.value)) {
      expiryError.innerText = 'Enter expiry as MM/YY.';
      expiryInput.classList.add('error');
      valid = false;
    } else {
      // Check if expired
      const parts = expiryInput.value.split('/');
      const month = parseInt(parts[0], 10);
      const year = parseInt('20' + parts[1], 10);
      const now = new Date();
      const expDate = new Date(year, month - 1, 1);
      if (expDate < new Date(now.getFullYear(), now.getMonth(), 1)) {
        expiryError.innerText = 'Card expired.';
        expiryInput.classList.add('error');
        valid = false;
      }
    }

    // CVV: exactly 3 digits
    if (!/^\d{3}$/.test(cvvInput.value)) {
      cvvError.innerText = 'Enter a valid 3-digit CVV.';
      cvvInput.classList.add('error');
      valid = false;
    }

    // Card Holder Name: non-empty
    if (cardHolderInput.value.trim().length < 3) {
      cardHolderError.innerText = 'Enter the card holder name.';
      cardHolderInput.classList.add('error');
      valid = false;
    }

    return valid;
  }

  payNowBtn.addEventListener('click', () => {
    if (!validateCardDetails()) return;

    showLoading();
    simulatePayment()
      .then(() => {
        showConfirmation();
      })
      .catch(() => {
        alert('Payment failed. Please try again.');
        showSection(cardFormSection);
      });
  });

  // Payment simulation for UPI and Card payments
  function processPayment(method) {
    showLoading();
    simulatePayment()
      .then(() => {
        showConfirmation();
      })
      .catch(() => {
        alert('Payment failed. Please try again.');
        if (method === 'UPI') {
          showSection(paymentSection);
        } else {
          showSection(cardFormSection);
        }
      });
  }

  function simulatePayment() {
    // Simulate a 2.5 second delay with progress bar
    return new Promise((resolve, reject) => {
      progressBar.style.width = '0%';
      progressBar.style.display = 'block';

      let progress = 0;
      const interval = setInterval(() => {
        progress += 4;
        if (progress > 100) progress = 100;
        progressBar.style.width = progress + '%';

        if (progress >= 100) {
          clearInterval(interval);
          progressBar.style.display = 'none';
          // Randomly decide success or failure (90% success)
          if (Math.random() < 0.9) resolve();
          else reject();
        }
      }, 100);
    });
  }

  function showLoading() {
    showSection(loadingSection);
  }

  // Generate random gift code (12 or 13 chars)
  function generateGiftCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    const length = Math.floor(Math.random() * 2) + 12; // 12 or 13
    let code = '';
    for (let i = 0; i < length; i++) {
      code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
  }

  // Show confirmation with generated code
  function showConfirmation() {
    showSection(confirmationSection);
    const codeElem = document.getElementById('gift-code');
    const code = generateGiftCode();
    codeElem.textContent = code;
  }

  // Copy gift code button
  document.getElementById('copy-code').addEventListener('click', () => {
    const code = document.getElementById('gift-code').textContent;
    navigator.clipboard.writeText(code).then(() => {
      alert('Gift code copied to clipboard!');
    }).catch(() => {
      alert('Failed to copy code.');
    });
  });

  // Start over button - back to home card selection
  document.getElementById('start-over').addEventListener('click', () => {
    // Reset everything
    selectedCard = '';
    amount = 0;
    email = '';
    toPaymentBtn.disabled = true;
    resetErrors();
    resetCardForm();
    cardOptions.forEach(c => c.classList.remove('selected'));
    showSection(null); // Hide all sections
    document.getElementById('amount-section').style.display = 'none';
    document.getElementById('payment-section').style.display = 'none';
    document.getElementById('card-form').style.display = 'none';
    document.getElementById('loading-section').style.display = 'none';
    document.getElementById('confirmation-section').style.display = 'none';

    // Show card options again (home)
    document.getElementById('card-options').style.display = 'flex' || 'block';
  });

  // On page load, show card options section only
  window.onload = () => {
    // Hide all except card options
    amountSection.style.display = 'none';
    paymentSection.style.display = 'none';
    cardFormSection.style.display = 'none';
    loadingSection.style.display = 'none';
    confirmationSection.style.display = 'none';
  };

</script>
</body>
</html>
